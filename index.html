<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>Agentes reativos - UNO</title>
	<script type="text/javascript" src="ClasseUNO.js"></script>
	<script type="text/javascript" src="Agente.js"></script>
</head>
<body>
	<h1>Jogo reativo de agente - UNO</h1>
	<script type="text/javascript">
		async function jogo(uno){
			console.log('Iniciando Jogo');

			//Instancia agentes
			let agente1 = new Agente(uno, 'Smith');
			let agente2 = new Agente(uno, 'NEO');
			
			//Agente capturam suas cartas iniciais
			await agente1.pegaCartaDoBaralho();
			await agente2.pegaCartaDoBaralho();
			// console.log('cartas agt1:', agente1.cartasNaMao);
			// console.log('cartas agt2:', agente2.cartasNaMao);


			//Inicia laço infinito
			//Cada agente realiza suas jogadas
			//Finaliza com uma chamada de expetion que caí no catch de fora
			for(let i = 0; i < 500; i++){
				try{
					await agente1.realizaJogada();
					console.log('Agente1');
					await agente2.realizaJogada();
					console.log('Agente2');
				}catch(error){
					console.warn('#1 Gerada Throw: ',error);
					return;
				}
				//console.log('Foi ',i,uno.ambiente);
			}
		}

		async function ambiente (){

			var uno = new UNO(); // Instância objeto, cria cartas do baralho			

			try{
				await uno.inicializaCartasDoBaralho(); // Cria cartas
				await uno.embaralharCartas(); // Embaralha cartas
				uno.ambiente.push(uno.cartas[27]); // Passando uma carta pro ambiente
				await jogo(uno);
			}catch(e){
				console.log(e); // O agente retornará uma exception dizendo o que está acontecendo, se ganhou ou acabaram as cartas
			}

		}

		ambiente();

		/**
		* TodoList:
		* Testar Promises do embaralhamento de cartas
		*/

	</script>
</body>
</html>